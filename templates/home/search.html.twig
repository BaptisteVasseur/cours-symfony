{% extends 'base.html.twig' %}

{% block title %}Recherche - Airbnb Clone{% endblock %}

{% block body %}

{% include 'parts/_header.html.twig' %}

<!-- Main Content -->
<main class="main-content">
    <!-- Search Section -->
    <section class="search-section">
        <div class="search-container">
            <h1>Rechercher un logement</h1>
            <form class="search-form" method="GET" action="{{ path('app_home_search') }}">
                <div class="search-filters">
                    <div class="filter-group">
                        <label for="location">Où</label>
                        <input type="text" id="location" name="location" placeholder="Rechercher une destination" value="{{ app.request.query.get('location', '') }}">
                    </div>

                    <div class="filter-group">
                        <label for="checkin">Arrivée</label>
                        <input type="date" id="checkin" name="checkin" value="{{ app.request.query.get('checkin', '') }}">
                    </div>

                    <div class="filter-group">
                        <label for="checkout">Départ</label>
                        <input type="date" id="checkout" name="checkout" value="{{ app.request.query.get('checkout', '') }}">
                    </div>

                    <div class="filter-group">
                        <label for="guests">Voyageurs</label>
                        <select id="guests" name="guests">
                            <option value="1" {{ app.request.query.get('guests', '1') == '1' ? 'selected' : '' }}>1 voyageur</option>
                            <option value="2" {{ app.request.query.get('guests', '1') == '2' ? 'selected' : '' }}>2 voyageurs</option>
                            <option value="3" {{ app.request.query.get('guests', '1') == '3' ? 'selected' : '' }}>3 voyageurs</option>
                            <option value="4" {{ app.request.query.get('guests', '1') == '4' ? 'selected' : '' }}>4 voyageurs</option>
                            <option value="5" {{ app.request.query.get('guests', '1') == '5' ? 'selected' : '' }}>5+ voyageurs</option>
                        </select>
                    </div>

                    <button type="submit" class="search-button">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                        Rechercher
                    </button>
                </div>
            </form>
        </div>
    </section>

    <!-- Results Section -->
    <section class="results-section">
        <div class="results-header">
            <h2>
                {% if properties is defined and properties|length > 0 %}
                    {{ properties|length }} logement{{ properties|length > 1 ? 's' : '' }} trouvé{{ properties|length > 1 ? 's' : '' }}
                {% else %}
                    Aucun résultat trouvé
                {% endif %}
            </h2>

            {# {% if app.request.query.all()|length > 0 %}
                <div class="active-filters">
                    {% for key, value in app.request.query.all() %}
                        {% if value is not empty %}
                            <span class="filter-tag">
                                {{ key|title }}: {{ value }}
                                <a href="{{ path('app_home_search', app.request.query.all()|merge({(key): ''})) }}" class="remove-filter">×</a>
                            </span>
                        {% endif %}
                    {% endfor %}
                    <a href="{{ path('app_home_search') }}" class="clear-all">Effacer tout</a>
                </div>
            {% endif %} #}
        </div>

        {% if properties is defined and properties|length > 0 %}
            <div class="properties-grid">
                {% for property in properties %}
                    {% include 'home/parts/_property-card.html.twig' %}
                {% endfor %}
            </div>
        {% else %}
            <div class="no-results">
                <div class="no-results-content">
                    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                        <circle cx="12" cy="10" r="3"></circle>
                    </svg>
                    <h3>Aucun logement trouvé</h3>
                    <p>Essayez de modifier vos critères de recherche ou explorez nos destinations populaires.</p>
                    <a href="{{ path('app_home') }}" class="cta-button">Voir les logements populaires</a>
                </div>
            </div>
        {% endif %}
    </section>
</main>

{% include 'parts/_footer.html.twig' %}

<style>
.search-section {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    padding: 60px 0;
    color: white;
}

.search-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

.search-container h1 {
    text-align: center;
    font-size: 2.5rem;
    margin-bottom: 40px;
    font-weight: 700;
}

.search-form {
    background: white;
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
}

.search-filters {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr 1fr auto;
    gap: 15px;
    align-items: end;
}

.filter-group {
    display: flex;
    flex-direction: column;
}

.filter-group label {
    font-weight: 600;
    color: #333;
    margin-bottom: 8px;
    font-size: 0.9rem;
}

.filter-group input,
.filter-group select {
    padding: 12px 16px;
    border: 2px solid #e1e5e9;
    border-radius: 8px;
    font-size: 1rem;
    transition: border-color 0.3s ease;
}

.filter-group input:focus,
.filter-group select:focus {
    outline: none;
    border-color: #667eea;
}

.search-button {
    background: #ff5a5f;
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: background-color 0.3s ease;
    height: fit-content;
}

.search-button:hover {
    background: #e04a4f;
}

.results-section {
    padding: 40px 0;
    max-width: 1200px;
    margin: 0 auto;
    padding-left: 20px;
    padding-right: 20px;
}

.results-header {
    margin-bottom: 30px;
}

.results-header h2 {
    font-size: 1.8rem;
    color: #333;
    margin-bottom: 20px;
}

.active-filters {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    align-items: center;
}

.filter-tag {
    background: #f7f7f7;
    padding: 8px 12px;
    border-radius: 20px;
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    gap: 8px;
}

.remove-filter {
    color: #666;
    text-decoration: none;
    font-weight: bold;
    font-size: 1.2rem;
    line-height: 1;
}

.remove-filter:hover {
    color: #ff5a5f;
}

.clear-all {
    color: #ff5a5f;
    text-decoration: none;
    font-weight: 600;
    margin-left: 10px;
}

.clear-all:hover {
    text-decoration: underline;
}

.properties-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 30px;
}

.no-results {
    text-align: center;
    padding: 80px 20px;
}

.no-results-content {
    max-width: 400px;
    margin: 0 auto;
}

.no-results-content svg {
    color: #ccc;
    margin-bottom: 20px;
}

.no-results-content h3 {
    font-size: 1.5rem;
    color: #333;
    margin-bottom: 15px;
}

.no-results-content p {
    color: #666;
    margin-bottom: 30px;
    line-height: 1.6;
}

.cta-button {
    display: inline-block;
    background: #ff5a5f;
    color: white;
    padding: 12px 24px;
    border-radius: 8px;
    text-decoration: none;
    font-weight: 600;
    transition: background-color 0.3s ease;
}

.cta-button:hover {
    background: #e04a4f;
    color: white;
}

@media (max-width: 768px) {
    .search-filters {
        grid-template-columns: 1fr;
        gap: 20px;
    }

    .search-container h1 {
        font-size: 2rem;
    }

    .properties-grid {
        grid-template-columns: 1fr;
    }
}
</style>

{% endblock %}
